ORG 0000H
SJMP MAIN
MAIN:MOV SP,#50H
MOV R0,#5H
MOV P0,#01H //P0 is used to control 7-seg LED displays
MOV P3,#24H //P3 is used to control RYG signal indication of 2 ways
MOV P1,#21H //P1 is used to control RYG signal indication of 2 ways
ACALL UP
MOV P0,#02H
MOV P3,#24H
MOV P1,#0CH
ACALL UP
MOV P0,#04H
MOV P3,#21H
MOV P1,#24H
ACALL UP
MOV P0,#08H
MOV P3,#0CH
MOV P1,#24H
ACALL UP
SJMP MAIN
UP: MOV P2,#90H //counter initialize at 9
ACALL DELAY
MOV P2,#80H
ACALL DELAY
MOV P2,#0F8H
ACALL DELAY
MOV P2,#82H
ACALL DELAY
MOV P2,#92H
ACALL DELAY
DJNZ R0,NEXT
SJMP MAIN //counter interrupt its counting at 4
NEXT:CJNE R0,#4H,NEXT1
MOV P1,#11H
SJMP UP2
NEXT1:CJNE R0,#3H,NEXT2
MOV P3,#22H
SJMP UP2
NEXT2:CJNE R0,#2H,NEXT3
MOV P3,#11H
SJMP UP2
NEXT3:CJNE R0,#1H,UP2
MOV P1,#22H
UP2: MOV P2,#99H //counter restarts counting from 5
ACALL DELAY
MOV P2,#0B0H
ACALL DELAY
MOV P2,#0A4H
ACALL DELAY
MOV P2,#0F9H
ACALL DELAY
MOV P2,#0C0H
ACALL DELAY
RET
DELAY:MOV R2,#0AH
LOOP1:MOV R3,#0C2H
LOOP2:MOV R4,#0FFH
LOOP: DJNZ R4,LOOP
DJNZ R3,LOOP2
DJNZ R2,LOOP1
RET
END
